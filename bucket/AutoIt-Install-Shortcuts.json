{
    "version": "200727.1758",
    "description": "Create AutoIt shortcuts",
    "homepage": "https://www.autoitscript.com/site/autoit/",
    "notes": "It will only create the shortcuts if the program is installed in the default location",
    "url": "https://raw.githubusercontent.com/ACooper81/SharedFiles/master/README.md",
    "hash": "f0947bfbb419bbaea8f2cf0dfee70dddff41da4ed64ebb8ed8eecab13de5c9b3",
    "installer": {
        "script": [
            "$ProgramFilesPath = [Environment]::GetFolderPath(\"ProgramFiles\")",
            "$ProgramFilesX86Path = [Environment]::GetFolderPath(\"ProgramFilesX86\")",
            "$StartMenuPath = [Environment]::GetFolderPath(\"StartMenu\")",
            "$CommonStartMenuPath = [Environment]::GetFolderPath(\"CommonStartMenu\")",
            "$EnvironmentSpecialFolder = \"https://docs.microsoft.com/en-us/dotnet/api/system.environment.specialfolder?view=netcore-3.1\"",
            "$ShortcutName = \"AutoIt\"",
            "$ShortcutProgramType = \"Programming\"",
            "$ShortcutTarget = \"$ProgramFilesX86Path\\AutoIt3\\AutoIt3Help.exe\"",
            "$ShortcutDestinationFolder = \"$CommonStartMenuPath\\$ShortcutProgramType\\AutoIt\"",
            "$ShortcutDestinationFile = \"$CommonStartMenuPath\\$ShortcutProgramType\\AutoIt Help File.lnk\"",
            "if (Test-Path \"$ShortcutTarget\")",
            "{",
            "   if(!(Test-Path -Path $ShortcutDestinationFolder )){New-Item -Path $ShortcutDestinationFolder -ItemType directory}",
            "   $WshShell = New-Object -comObject WScript.Shell",
            "   $Shortcut = $WshShell.CreateShortcut(\"$ShortcutDestinationFile\")",
            "   $Shortcut.TargetPath = \"$ShortcutTarget\"",
            "   $Shortcut.Save()",
            "   $Shortcut2 = $WshShell.CreateShortcut(\"$ShortcutDestinationFolder\\AutoIt Window Info (x86).lnk\")",
            "   $Shortcut2.TargetPath = \"$ProgramFilesX86Path\\AutoIt3\\Au3Info.exe\"",
            "   $Shortcut2.Save()",
            "   $Shortcut3 = $WshShell.CreateShortcut(\"$ShortcutDestinationFolder\\AutoIt Window Info (x64).lnk\")",
            "   $Shortcut3.TargetPath = \"$ProgramFilesX86Path\\AutoIt3\\Au3Info_x64.exe\"",
            "   $Shortcut3.Save()",
            "   $Shortcut4 = $WshShell.CreateShortcut(\"$ShortcutDestinationFolder\\Compile Script to .exe (x86).lnk\")",
            "   $Shortcut4.TargetPath = \"$ProgramFilesX86Path\\AutoIt3\\Aut2Exe\\Aut2exe.exe\"",
            "   $Shortcut4.Save()",
            "   $Shortcut5 = $WshShell.CreateShortcut(\"$ShortcutDestinationFolder\\Compile Script to .exe (x64).lnk\")",
            "   $Shortcut5.TargetPath = \"$ProgramFilesX86Path\\AutoIt3\\Aut2Exe\\Aut2exe_x64.exe\"",
            "   $Shortcut5.Save()",
            "   $Shortcut6 = $WshShell.CreateShortcut(\"$ShortcutDestinationFolder\\Run Script (x86).lnk\")",
            "   $Shortcut6.TargetPath = \"$ProgramFilesX86Path\\AutoIt3\\AutoIt3.exe\"",
            "   $Shortcut6.Save()",
            "   $Shortcut7 = $WshShell.CreateShortcut(\"$ShortcutDestinationFolder\\Run Script (x64).lnk\")",
            "   $Shortcut7.TargetPath = \"$ProgramFilesX86Path\\AutoIt3\\AutoIt3_x64.exe\"",
            "   $Shortcut7.Save()",
            "   $Shortcut8 = $WshShell.CreateShortcut(\"$ShortcutDestinationFolder\\SciTE Script Editor.lnk\")",
            "   $Shortcut8.TargetPath = \"$ProgramFilesX86Path\\AutoIt3\\SciTE\\SciTE.exe\"",
            "   $Shortcut8.Save()",
            "}",
            "else",
            "{",
            "   exit 1",
            "}",
            "Remove-Item \"$dir\\README.md\" -Force"
        ]
    }
}
